---
title: "Introduction to the mondate Package"
author: "Dan Murphy"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
#output: rmarkdown::word_document
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

There are two broad date/time classes in base R,
`POSIXt` and `Date`.
Objects of these classes
mark a day with the instant of
time that begins the day. 
This conforms with 
internationally recognized 
standards^[Refer to http://www.iso.org/iso/home/standards/iso8601.htm
or
https://en.wikipedia.org/wiki/ISO_8601].
In contrast, 
`mondate` objects represent a day as at the instant of time that ends the day.
This "close of business" perspective can be useful, 
as when modeling accounting as-of dates.

The four major benefits of the mondate package are:

1. Date Aging
1. Date Formatting
1. Date Sequencing
1. Date Cutting

## Date Aging

The "age" of an event plays many important roles in business use cases.
For example, 
if my "birth event" took place on February 29, 1996
then my age on February 28, 2015 was 19:

```{r birthday}
require(mondate)
YearsBetween("1996-02-29", "2015-02-28")
```
or in the US
```{r}
YearsBetween("2/29/1996", "2/28/2015")
```

As another example,
suppose ABC Company invoices a customer at end of November 2015
and has a policy of recognizing those invoices to have been sent
on the 1st of October.
This code calculates the age of that invoice in months 
as of the end of 2015 and 2016:

```{r}
invoiceDate = as.Date("2015-11-01")
age = mondate.ymd(2015:2016) - invoiceDate
print(age)
```

### Actuarial example

See the "Date Cutting" section below for a better way to do this calculation.

## Date Formatting

`mondate` enables dates to be read and displayed in more than one format.
The default formats currently recognized are

* US format: "%m/%d/%Y" or "%m-%d-%Y"
* EU format: "%Y-%m-%d" or "%Y/%m/%d"

in that order,
depending on your value of `Sys.getlocale("LC_TIME")`.
The order can be changed and new formats added using `base::options`.

For example,
this vignette is being written in the US, 
so today's date will be represented using the first choice above by default ...

```{r}
mondate(Sys.Date())
```

... but that default can be changed to the
international standard format^[ibid.]
"YYYY-MM-DD" as follows

```{r}
options(mondate.displayFormat = "%Y-%m-%d")
mondate(Sys.Date())
```

As another example, 
French users may choose the format "dd/mm/YYYY" as follows:

```{r}
options(mondate.displayFormat = "%d/%m/%Y")
mondate(Sys.Date())
```

Note: 
these examples show how to modify the default display format
for **all** mondates in your session.
To set the display format for **just one** instance of a mondate object,
use the `displayFormat` argument during its creation.

For example,
here we ceate the first 6 month-ends of 2015
to be displayed in the French format above
despite the fact that the default format is changed to the ISO standard:

```{r}
options(mondate.displayFormat = "%Y-%m-%d")
mondate(Sys.Date())
m <- mondate.ymd(2015, 1:6, displayFormat = "%d/%m/%Y")
print(m)
```
```{r echo=FALSE, message=FALSE}
options(mondate.displayFormat = NULL)
```
```{r}

```

More creative formats can be used, as for instance
to display just the year and month.
For example, here we create the first six 
month-ends of 2016 whose display will omit the day.
(It is *not* recommended to do this by default!)

```{r}
m <- mondate.ymd(2016, 1:6, displayFormat = "%Y%m")
print(m)
```

### Dynamic format detection

For more information on the codes to use when formatting dates,
see the R help page for the `strptime` function.
To add addtional defaults according to your value of
`Sys.getlocale("LC_TIME")`,
contact the 
author^[chiefmurphy at gmail].
(Please visit the package repository at
https://github.com/chiefmurph/mondate.)

## Date Sequencing
## Date Cutting

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.

## Styles

The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:

    output: 
      rmarkdown::html_vignette:
        css: mystyles.css

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
